define(["stateMachine","commandBar","dialogModal","interactiveObjects","modalScene"],function(e,t,n,r,i){function c(){p(e.getCurrentLevel()),d()}function h(){return s}function p(e){s=$.extend(!0,{},e),o=s.getActions(),a=s.getDialogs(),u=s.getInteractiveObjects(),f=s.getFlags(),l=s.getCurrentSceneId()}function d(){v(s.getCurrentSceneId())}function v(e){s.setCurrentSceneById(e),l=e;var n=s.getCurrentScene();$("#backgroundScene").attr("class",n.getCssClass()),t.changeToActionsButtons(o[l]),r.changeToInteractiveObjects(u[l])}function m(e){}function g(){}function y(e,t){var r=a[e][t];n.show(r)}function b(){n.close()}function w(){}function E(){}function S(e,t){return f[e][t]}function x(e,t,n){f[e][t]=n}var s,o,u,a,f,l;return{start:c,changeScene:v,openDialog:y,closeDialog:b,openModalScene:m,closeModalScene:g,openEndLevel:w,closeEndLevel:E,getCurrentLevel:h,getFlag:S,setFlag:x}});