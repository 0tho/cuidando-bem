<!DOCTYPE html>
<html>
<head>
	<title>Teste de animação</title>
</head>
<body>	
	<canvas id="canvas"></canvas>

	<script type="text/javascript">

	//Frame = each time things are draw in screen
	//Tick = each time things get a logical update

	var last = new Date().getTime();
	var passed;
	var now;
	var accumulator = 0;

	var tickTime = 1000/60;

	var canvas = document.getElementById('canvas');

	canvas.setAttribute('width', 1920);
	canvas.setAttribute('height', 1152);
	

	function Clip(){
		this.x;
		this.y;

		this.frameTime;
		this.accumulator = 0;
		this.frameTotal;
		this.frameCounter = 0;
		
		this.img = [];
		this.hasToDraw = false;

		this.width;
		this.height;


		this.update = function(){

			this.accumulator += tickTime;

			while(this.accumulator >= this.frameTime){

				this.frameCounter++;
				this.frameCounter = this.frameCounter % this.frameTotal;
				this.hasToDraw = true;

				this.accumulator -=this.frameTime;
			}
		}

		this.draw = function(canvas){

			var ctx = canvas.getContext('2d');

			var fx = this.frameCounter * this.width; 

			var img = this.img[this.frameCounter];

			ctx.drawImage(img, 0, 0, this.width, this.height, 0, 0, this.width, this.height);
		}
	}

	var coin = new Clip();
	coin.width = 1920;
	coin.height = 1152;
	coin.frameTotal = 12;
	coin.frameTime = 1000*60/18/coin.frameTotal;

	coin.img = [];


	var imgsLoaded = 0;
	for(i=0; i<coin.frameTotal; i++){
		coin.img.push(new Image());

		coin.img[i].onload = function(){ 
			console.log("Image "+i+" loaded");
			imgsLoaded++;
			if(imgsLoaded==coin.frameTotal){
				gameLoop();
			}
		};

		var img = coin.img[i];

		if(i<10){
			i = "0"+i;
		}

		img.src = "./anim/01_"+i+".png";
	}

	function gameLoop(){
		console.log("loop");
		now = new Date().getTime();
		passed = now-last;
		last = now;
		accumulator += passed;

		while(accumulator >= tickTime){
			coin.update();

			accumulator -=tickTime;
		}


		if(coin.hasToDraw){
			var ctx = canvas.getContext('2d');

			ctx.fillStyle = "#FFFFFF";
            ctx.fillRect(0,0, coin.width, coin.height);

			coin.draw(canvas);
		}


		window.requestAnimationFrame(gameLoop);	
	}

	</script>
</body>
</html>