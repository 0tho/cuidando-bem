/*
This file is part of Cuidando Bem.

    Cuidando Bem is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Cuidando Bem is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Cuidando Bem.  If not, see <http://www.gnu.org/licenses/>.
*/

define(["Stage","levelsData","commandBar","dialogModal","interactiveObjects","modalScene","scene","endOfLevel","Prontuario","Pulseira","FreqRespiratoria","EquipoGotejamento","Ficha"],function(e,t,n,i,c,o,s,a,l,r,u,g,b){function v(){s.init(oe),o.init(oe),c.init(oe),a.init(oe),l.init(oe),r.init(oe),u.init(oe),g.init(oe),b.init(oe),i.init(oe),n.init(oe),I(t.getCurrentLevel()),j()}function f(e){O(e)}function d(){m(),I(t.getCurrentLevel()),j()}function A(){return X}function I(e){X=e.getClone(),r.resetData(),X.setup(),i.close(),ne=X.getCurrentSceneId()}function O(e){t.setCurrentLevel(e),I(t.getCurrentLevel()),j()}function j(){X.setCurrentSceneById(ne),Y=X.getCurrentScene(),Z=X.getActions(ne),ee=X.getDialogs(ne),_=X.getInteractiveObjects(ne),te=X.getFlags(),ie=[],s.setScene(Y),n.changeToActionsButtons(Z),c.changeToInteractiveObjects(_),a.close(),l.close(),r.close(),u.close(),g.close(),b.close(),i.close(),n.hide(),Y.load()}function C(e){var t=Y;X.setCurrentSceneById(e),Y=X.getCurrentScene(),ne=e,Z=X.getActions(ne),ee=X.getDialogs(ne),_=X.getInteractiveObjects(ne),te=X.getFlags(),t.unload(),s.changeScene(Y),n.changeToActionsButtons(Z),c.changeToInteractiveObjects(_),Y.load()}function h(e){var t=X.getModalScene(e);Y=t,o.open(t),n.changeToActionsButtons(t.getActions()),c.changeToInteractiveObjects(t.getInteractiveObjects())}function S(){o.close(),n.changeToActionsButtons(Z),c.changeToInteractiveObjects(_),Y=X.getCurrentScene()}function V(){n.show()}function B(){n.hide()}function p(e){var t=ee[e];i.show(t),se.play(se.audios.sfx.avancarMensagens),T(),F(),B()}function y(){i.close(),se.play(se.audios.sfx.avancarMensagens),M(),E(),V()}function L(){a.show(ie,X.getMaxPoints())}function m(){a.close()}function T(){n.disableAllActionButtons(Z)}function F(){c.disableAllInteractiveObjects(_)}function E(){c.updateAllInteractiveObjects(_)}function M(){n.updateAllActionButtons(Z)}function D(e){var t=Y.getAction(e);t.setEnable(!1),n.disableActionButton(t)}function q(e){var t=Y.getAction(e);t.setEnable(!0),n.enableActionButton(t)}function w(e){var t=Y.getInteractiveObject(e);t.setEnable(!1),c.disableInteractiveObject(t)}function P(e){var t=Y.getInteractiveObject(e);t.setEnable(!0),c.enableInteractiveObject(t)}function k(e){return X.getFlag(e)}function x(e,t){return"undefined"==typeof t?X.getFlag(e).getValue():void X.getFlag(e).setValue(t)}function G(e,t){X.setFlag(e,t)}function R(e,t){var n=Y.getAction(e);"undefined"!=typeof t?q(n):D(n)}function z(e,t){var i=Y.getAction(e);i.setVisibility(t),n.setActionVisible(i,t)}function H(e){var t=Y.getAction(e);t.isVisible()?t.setVisibility(!1):t.setVisibility(!0),n.setActionVisible(t,t.isVisible())}function J(e,t){var n=Y.getInteractiveObject(e);n.setVisibility(t),c.setInteractiveObjectVisible(n,t)}function K(e){var t=Y.getInteractiveObject(e);t.isVisible()?t.setVisibility(!1):t.setVisibility(!0),c.setInteractiveObjectVisible(t,t.isVisible())}function N(e){ie.push(e),ce.addScore(t.getCurrentLevelId(),e)}function Q(){e.changeScreen(6)}function U(e){var t="."+Y.getCssClass(),n="."+e;$(t).addClass(e),$(n).removeClass(Y.getCssClass()),Y.setCssClass(e)}function W(e){ce.unlockLevel(e)}var X,Y,Z,_,ee,te,ne,ie,ce=require("Storage"),oe="#gameStage",se=require("Player"),ae={init:v,start:f,restartLevel:d,changeScene:C,changeLevelTo:O,openDialog:p,closeDialog:y,openModalScene:h,closeModalScene:S,showEndOfLevel:L,closeEndOfLevel:m,openCommandBar:V,closeCommandBar:B,unlockLevel:W,enableActionButton:q,disableActionButton:D,enableInteractiveObject:P,disableInteractiveObject:w,setActionEnable:R,getCurrentLevel:A,getFlag:k,setFlag:G,flag:x,setActionVisible:z,toggleActionVisible:H,setInteractiveObjectVisible:J,toggleInteractiveObjectVisible:K,registerScoreItem:N,disableAllActionButtons:T,updateAllActionButtons:M,disableAllInteractiveObjects:F,updateAllInteractiveObjects:E,goBackToMenu:Q,changeSceneCssClassTo:U};return ae});