/*
 This file is part of Cuidando Bem.

 Cuidando Bem is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.

 Cuidando Bem is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.

 You should have received a copy of the GNU General Public License
 along with Cuidando Bem.  If not, see <http://www.gnu.org/licenses/>.
 */

define(["levelsData","Scene","Action","Level","Dialog","InteractiveObject","Flag","CuidandoBem","Commons","Pulseira","Prontuario","FreqRespiratoria","ScoresData"],function(e,a,o,i,r,n,s,t,c,l,g,p,m){function f(){t.flag("conversar_recepcionista")&&(t.closeDialog(),t.changeScene(1))}function u(){t.openDialog(0)}function _(){t.flag("examinar_paciente")?t.changeScene(4):(t.openDialog(10),t.flag("score_ir_posto_hora_errada")||t.flag("score_ir_posto_hora_errada",!0))}function d(){t.flag("conversar_mentor")&&(t.flag("examinar_paciente")?t.flag("coxim")?t.changeScene(2):t.openDialog(11):t.changeScene(2))}var C=require("DialogsData").fase2,b=require("DialogsData").alertas,v=require("Player");m=m.fase2;var w=new i("Level 2");w.setMaxPoints(m._sum);var x,D,O,h,M,j,S,V,A;x=c.scenes.recepcao.getClone().onLoad(function(){t.flag("conversar_recepcionista")||(t.flag("conversar_recepcionista",!0),t.openDialog(0))}),x.registerDialogs([new r(c.characters.recepcionista).setText(C.recepcao[0]).registerOption("",function(){t.flag("conversar_recepcionista",!0),t.openDialog(1)}),new r(c.characters.jogador).setText(C.recepcao[1]).registerOption("",function(){t.closeDialog()})]),x.registerInteractiveObjects([new n("intObj-conversar_recepcionista","Conversar com a Recepcionista").setCssClass("intObj-talkToReceptionist").setVisibility(!0).onClick(u),new n("io-ir_corredor_direita","Ir ao corredor").setCssClass("intObj-porta").onClick(f).setVisibility(!0)]),D=c.scenes.corredor.getClone().onLoad(function(){t.openCommandBar(),t.setActionVisible("btn-ir_recepcao",!0),v.play(v.audios.sfx.abrirPorta),v.playInLoop(v.audios.sfx.recepcao),t.flag("conversar_mentor")?t.flag("examinar_paciente")&&!t.flag("conversar_mentor2")&&t.openDialog(2):(t.flag("conversar_mentor",!0),t.openDialog(0))}).onUnload(function(){v.stopLoop()}),D.registerActions([new o("btn-ir_recepcao","Voltar para a recepção").setCssClass("action-voltarRecepcao").onClick(function(){t.changeScene(0)}).setVisibility(!0)]),D.registerDialogs([new r(c.characters.mentor).setText(C.corredor.fala1[0]).registerOption("",function(){t.flag("conversar_mentor",!0),t.openDialog(1)}),new r(c.characters.jogador).setText(C.corredor.fala1[1]).registerOption("",function(){t.closeDialog()}),new r(c.characters.mentor).setText(C.corredor.fala2[0]).registerOption("",function(){t.openDialog(3)}),new r(c.characters.jogador).setText("").registerOption(C.corredor.fala2[1],function(){t.openDialog(6)}).registerOption(C.corredor.fala2[2],function(){t.openDialog(4)}).registerOption(C.corredor.fala2[4],function(){t.openDialog(5)}).setRandomize(!0),new r(c.characters.mentor).setText(C.corredor.fala2[3]).registerOption("",function(){t.openDialog(3)}),new r(c.characters.mentor).setText(C.corredor.fala2[5]).registerOption("",function(){t.openDialog(3)}),new r(c.characters.mentor).setText(C.corredor.fala2[6]).registerOption("",function(){t.openDialog(7)}),new r(c.characters.jogador).setText("").registerOption(C.corredor.fala2[7],function(){t.closeDialog(),t.openCommandBar(),t.flag("conversar_mentor2",!0),t.flag("score_falar_com_mentor")||t.flag("score_falar_com_mentor",!0)}).registerOption(C.corredor.fala2[8],function(){t.openDialog(8)}).registerOption(C.corredor.fala2[10],function(){t.openDialog(9)}).setRandomize(!0),new r(c.characters.mentor).setText(C.corredor.fala2[9]).registerOption("",function(){t.openDialog(7)}),new r(c.characters.mentor).setText(C.corredor.fala2[11]).registerOption("",function(){t.openDialog(7)}),new r(c.characters.mentor).setText(b.enfermariaMasculina).registerOption("",function(){t.closeDialog()}),new r(c.characters.mentor).setText(b.perdido.enfermagem[0]).registerOption("",function(){t.closeDialog()})]),D.registerInteractiveObjects([new n("io-ir_sala_leitos","Ir à Enfermaria Masculina").setCssClass("intObj-goToBedroom").onClick(d).setVisibility(!0),new n("io-ir_posto_enfermagem","Ir ao Posto de Enfermagem").setCssClass("intObj-goToNursingStation").onClick(_).setVisibility(!0),new n("io-conversar_mentor","Conversar com Mentor").setCssClass("intObj-talkToMentor").onClick(function(){t.closeCommandBar(),t.flag("examinar_paciente")?t.flag("examinar_paciente")&&t.openDialog(2):(t.flag("conversar_mentor",!0),t.openDialog(0))}).setVisibility(!0)]),O=new a("salaDeLeitos","scene-salaDeLeitos").setCssClass("scene-bedroom-level2a").onLoad(function(){t.flag("colocou_coxim")&&(t.setActionVisible("btn-ler_prontuario",!0),t.setActionVisible("btn-lavarMaos",!0),t.changeSceneCssClassTo("scene-bedroom-level2b"),t.setInteractiveObjectVisible("io-ir_leito",!1)),t.openCommandBar()}).onUnload(function(){t.closeCommandBar()}),O.registerInteractiveObjects([new n("io-falar_paciente","Falar com o paciente").setCssClass("intObj-ir_leito-fase1").onClick(function(){t.flag("lavarMaos")?t.changeScene(3):t.openDialog(0)}).setVisibility(!0),new n("io-ir_leito","Ir ao leito").setCssClass("intObj-ir_leito-fase1").onClick(function(){t.changeScene(3)}).setVisibility(!0),new n("io-ir_corredor","Ir ao Corredor").setCssClass("intObj-bedroomToHallway").onClick(function(){t.flag("foi_ao_leito")?t.flag("lavar_maos2")?t.changeScene(1):t.openDialog(1):t.changeScene(1)}).setVisibility(!0)]),O.registerActions([new o("btn-lavarMaos","Lavar as mãos").setCssClass("action-lavarMaos").onClick(function(){v.play(v.audios.sfx.lavarMaos),0==t.flag("lavar_maos3")&&(t.flag("lavar_maos3",!0),t.registerScoreItem(m.lavarMaosDepois))}).setVisibility(!1),new o("btn-ler_prontuario","Anotar no prontuario").setCssClass("action-ler_prontuario").onClick(function(){t.flag("lavar_maos3")?(t.flag("score_ler_prontuario")||(t.flag("score_ler_prontuario",!0),t.registerScoreItem(m.lerProntuario)),g.open("prescEnfermagem"),t.openModalScene("Prontuario")):t.openDialog(2)}).setVisibility(!1)]),O.registerDialogs([new r(c.characters.mentor).setText(b.lavarMaos.tipo1).registerOption("",function(){t.closeDialog()}),new r(c.characters.mentor).setText(b.lavarMaos.tipo2).registerOption("",function(){t.closeDialog()}),new r(c.characters.mentor).setText(b.lavarMaos.tipo3).registerOption("",function(){t.closeDialog()})]),h=c.scenes.leitos.carlos.getClone().onLoad(function(){t.openCommandBar(),t.flag("examinar_paciente")||t.setInteractiveObjectVisible("io-pulseira_paciente",!0),t.flag("conversar_mentor2")&&(t.setActionVisible("btn-examinar_paciente",!1),t.flag("coxim")&&(t.setInteractiveObjectVisible("io-conversar_paciente02",!1),t.flag("mudar_posicao_paciente")?t.flag("colocou_coxim")||(t.setActionVisible("btn-mudar_posicao",!1),t.setInteractiveObjectVisible("io-pulseira_paciente",!1),t.setActionVisible("btn-posicionar_coxim_e_travesseiro",!0)):t.setActionVisible("btn-mudar_posicao",!0)))}).onUnload(function(){t.closeCommandBar()}),h.registerInteractiveObjects([new n("io-pulseira_paciente","Checar pulseira do paciente").setCssClass("intObj-paciente_02-checar_pulseira").onClick(function(){t.flag("lavarMaosAntesInspecao")?(t.openModalScene("pulseira"),l.open(),t.openCommandBar()):t.openDialog(11)}).setVisibility(!0).setEnable(!1),new n("io-pulseira_paciente2","Checar pulseira do paciente").setCssClass("intObj-paciente_02-checar_pulseira_virado").onClick(function(){t.openModalScene("pulseira2"),l.open(),t.openCommandBar()}).setVisibility(!1),new n("io-conversar_paciente02","Falar com o paciente").setCssClass("intObj-conversar_paciente").onClick(function(){t.flag("score_falar_paciente")||(t.registerScoreItem(m.falarComPaciente),t.flag("score_falar_paciente",!0)),t.openDialog(0),t.closeCommandBar()}).setVisibility(!0)]),h.registerDialogs([new r(c.characters.jogador).setText("").registerOption(C.enfermaria[0],function(){t.openDialog(3)}).registerOption(C.enfermaria[1],function(){t.openDialog(1)}).registerOption(C.enfermaria[3],function(){t.openDialog(2)}).setRandomize(!0),new r(c.characters.mentor).setText(C.enfermaria[2]).registerOption("",function(){t.openDialog(0)}),new r(c.characters.mentor).setText(C.enfermaria[4]).registerOption("",function(){t.openDialog(0)}),new r(c.characters.pacientes.carlos).setText(C.enfermaria[5]).registerOption("",function(){t.openDialog(4)}),new r(c.characters.jogador).setText("").registerOption(C.enfermaria[6],function(){t.openDialog(7)}).registerOption(C.enfermaria[7],function(){t.openDialog(5)}).registerOption(C.enfermaria[9],function(){t.openDialog(6)}).setRandomize(!0),new r(c.characters.mentor).setText(C.enfermaria[8]).registerOption("",function(){t.openDialog(4)}),new r(c.characters.mentor).setText(C.enfermaria[10]).registerOption("",function(){t.openDialog(4)}),new r(c.characters.pacientes.carlos).setText(C.enfermaria[11]).registerOption("",function(){t.openDialog(10)}),new r(c.characters.jogador).setText(C.perguntarNome).registerOption("",function(){t.openDialog(9)}),new r(c.characters.pacientes.carlos).setText(C.enfermaria[11]).registerOption("",function(){t.openCommandBar(),t.closeDialog()}),new r(c.characters.jogador).setText(C.enfermaria[12]).registerOption("",function(){t.openCommandBar(),t.closeDialog(),t.flag("conversarPaciente",!0),t.enableInteractiveObject("io-pulseira_paciente",!0),t.setActionVisible("btn-ir_sala_leitos",!0),t.setActionVisible("btn-lavarMaos",!0)}),new r(c.characters.mentor).setText(C.enfermaria[13]).registerOption("",function(){t.closeDialog()})]),h.registerActions([new o("btn-examinar_paciente","Inspecionar Pele").setCssClass("action-examinar_paciente").onClick(function(){v.play(v.audios.sfx.toquePele),t.openModalScene("zoomChar2"),t.flag("examinar_paciente",!0)}).setVisibility(!1),new o("btn-lavarMaos","Lavar as mãos").setCssClass("action-lavarMaos").onClick(function(){v.play(v.audios.sfx.lavarMaos),0==t.flag("lavarMaosAntesInspecao")&&t.flag("lavarMaosAntesInspecao",!0),0==t.flag("score_lavarMaosAntesInspecao")&&(t.flag("score_lavarMaosAntesInspecao",!0),t.registerScoreItem(m.lavarMaosAntes))}).setVisibility(!1),new o("btn-perguntar_nome","Perguntar nome do paciente").setCssClass("action-leito-char-02").onClick(function(){t.closeCommandBar(),t.openDialog(8)}).setVisibility(!1),new o("btn-ir_sala_leitos","Ir para sala de leitos").setCssClass("action-ir_sala_de_leitos").onClick(function(){t.flag("examinar_paciente"),t.changeScene(2)}).setVisibility(!1),new o("btn-mudar_posicao","Mudar posição do paciente").setCssClass("action-mudar_posicao_paciente").onClick(function(){v.play(v.audios.sfx.roupaRocando),t.changeSceneCssClassTo("scene-bedChar02-turned"),t.setActionVisible("btn-mudar_posicao",!1),t.setInteractiveObjectVisible("io-pulseira_paciente",!1),t.setInteractiveObjectVisible("io-pulseira_paciente2",!0),t.setActionVisible("btn-posicionar_coxim_e_travesseiro",!0),t.flag("mudar_posicao_paciente",!0),t.flag("score_mudar_posicao")||(t.flag("score_mudar_posicao",!0),t.registerScoreItem(m.mudarPosicaoCoxim))}).setVisibility(!1),new o("btn-posicionar_coxim_e_travesseiro","Posicionar coxim e travesseiro").setCssClass("action-posicionar_coxim").onClick(function(){v.play(v.audios.sfx.objetoRocando),t.changeSceneCssClassTo("scene-bedChar02-cushion"),t.setActionVisible("btn-posicionar_coxim_e_travesseiro",!1),t.flag("colocou_coxim",!0)}).setVisibility(!1)]),M=c.scenes.postoDeEnfermagem.getClone().onLoad(function(){t.openCommandBar()}).onUnload(function(){t.closeCommandBar()}),M.registerActions([new o("btn-lavarMaos","Lavar as mãos").setCssClass("action-lavarMaos").onClick(function(){v.play(v.audios.sfx.lavarMaos),0==t.flag("lavarMaosAntesBandeja")&&t.flag("lavarMaosAntesBandeja",!0),0==t.flag("score_lavarMaosAntesBandeja")&&(t.flag("score_lavarMaosAntesBandeja",!0),t.registerScoreItem(m.lavarMaosAntesBandeja))}).setVisibility(!0),new o("btn-ir_corredor","Ir ao corredor").setCssClass("action-ir_corredor").onClick(function(){t.flag("coxim")?t.changeScene(1):t.openDialog(0)}).setVisibility(!0)]),M.registerInteractiveObjects([new n("io-abrirGaveta","Abrir gaveta").setCssClass("intObj-openDrawer").onClick(function(){t.flag("pegou_bandeja")?(v.play(v.audios.sfx.abrirGaveta),t.openModalScene("gaveta"),t.openCommandBar(),t.setInteractiveObjectVisible("io-coxim",!t.flag("coxim"))):t.openDialog(1)}).setVisibility(!0),new n("io-pegar_bandeja","Pegar bandeja").setCssClass("intObj-bandeja").onClick(function(){t.flag("lavarMaosAntesBandeja")?(v.play(v.audios.sfx.pegarObjeto),t.flag("pegou_bandeja",!0),t.setInteractiveObjectVisible("io-pegar_bandeja",!1)):t.openDialog(2)}).setVisibility(!0)]),M.registerDialogs([new r(c.characters.mentor).setText(b.esqueceu.coxim).registerOption("",function(){t.closeDialog()}),new r(c.characters.mentor).setText(b.esqueceu.pegarBandeja).registerOption("",function(){t.closeDialog()}),new r(c.characters.mentor).setText(b.esqueceu.lavarMaosAntesBandeja).registerOption("",function(){t.closeDialog()})]),A=new a("zoomChar2","Examinando paciente").setCssClass("modalScene-zoom-char2"),A.registerActions([new o("btn-fechar_zoom","Finalizar Inspeção").setCssClass("action-terminar_exame").onClick(function(){t.closeModalScene("zoomChar2"),t.setActionVisible("btn-ir_sala_leitos",!0),t.flag("score_examinar_paciente")||(t.registerScoreItem(m.examinarPaciente),t.flag("score_examinar_paciente",!0))})]),S=new a("pulseira","pulseira"),S.registerInteractiveObjects([]),S.registerActions([new o("btn-largar_pulseira","Fechar pulseira").setCssClass("action-pulseira_paciente").onClick(function(){t.closeModalScene("Pulseira"),!t.flag("confirmou_pulseira")&&t.flag("conversarPaciente")&&(t.flag("confirmou_pulseira",!0),t.setActionVisible("btn-examinar_paciente",!0),t.flag("score_verificar_pulseira")||(t.registerScoreItem(m.verificarPulseira),t.flag("score_verificar_pulseira",!0))),l.close()}).setVisibility(!0)]),pulseira2=new a("pulseira2","pulseira2"),pulseira2.registerInteractiveObjects([]),pulseira2.registerActions([new o("btn-largar_pulseira","Fechar pulseira").setCssClass("action-pulseira_paciente").onClick(function(){t.closeModalScene("Pulseira"),l.close()}).setVisibility(!0)]),j=new a("gaveta","Gaveta").setCssClass("modalScene-drawer"),j.registerActions([new o("btn-fecharGaveta","Fechar gaveta").setCssClass("action-fecharGaveta").onClick(function(){v.play(v.audios.sfx.fecharGaveta),t.closeModalScene("Gaveta")}).setVisibility(!0)]),j.registerInteractiveObjects([new n("io-coxim","Coxim").setCssClass("intObj-cushion").onClick(function(){t.flag("coxim",!0),v.play(v.audios.sfx.pegarObjeto),t.setInteractiveObjectVisible("io-coxim",!1),t.flag("score_pegar_coxim")||(t.registerScoreItem(m.pegarCoxim),t.flag("score_pegar_coxim",!0))}).setVisibility(!0)]),V=new a("Prontuario","Prontuario"),V.registerActions([new o("btn-fechar_prontuario","Fechar prontuário").setCssClass("action-ler_prontuario").onClick(function(){g.close(),t.closeModalScene("Prontuario"),g.isDataValid()&&(t.registerScoreItem(m.anotarNoProntuario),t.unlockLevel(3),t.closeCommandBar(),t.showEndOfLevel(),v.stopAll(),v.play(v.audios.sfx.missaoCumprida))})]),w.registerScene(x),w.registerScene(D),w.registerScene(O),w.registerScene(h),w.registerScene(M),w.registerModalScene(S),w.registerModalScene(pulseira2),w.registerModalScene(j),w.registerModalScene(V),w.registerModalScene(A),w.setSetupScript(function(){l.setNameRegExp(/^Carlos Esme Gouv(e|ê)a$/i),l.setLeitoRegExp(/0*3/),l.setDataRegExp(/01\/12\/1945/),l.setName("Carlos Esme Gouvêa"),l.setLeito("03"),l.setData("01/12/1945"),l.disable(),g.setNome("Carlos Esme Gouvêa"),g.setSexo("M"),g.setEstadoCivil("Casado"),g.setDataNascimento("01/12/1945"),g.setIdade("69 anos"),g.setProfissao("Aposentado (advogado)"),g.setPai("Leonardo Gouvêa"),g.setMae("Maria Clara Esme Gouvêa"),g.setAlergiaMedicamentosa(!1,""),g.setDisableAlergiaMedicamentosa(!0),g.setDataInternacao("15/06/2015"),g.setLeito("02 - Enfermaria Masculina"),g.setAntecedentes("Nenhum"),g.setHipotese("Pneumonia brônquica, insuficiência respiratória e anemia ferropriva."),g.setObservacoes("Possui incontinência urinária, acamado."),g.setPrescEnfermagemState(["decubito"]),g.setPeso("72"),g.setAltura("1,68"),g.setCircunferenciaAbdominal("135"),g.setPrescMedicaRowData(0,"","Sulfato ferroso","Oral","drágea 250 mg","2x dia",!0,!0),g.setPrescMedicaRowData(1,"","Azitromicina","Oral","comp 500 mg","1x dia",!0,!0),g.setPrescMedicaRowData(2,"","","","","",!1,!0),g.setPrescMedicaRowData(3,"","","","","",!1,!0),g.setSsvvRowData(0,"","130x80","65","14","94","36",!0),g.setSsvvRowData(1,"","","","","","",!0),g.setAnotacaoEnfermagemRowData("","")}),w.registerFlag(new s("conversar_recepcionista",!1)),w.registerFlag(new s("conversar_mentor",!1)),w.registerFlag(new s("conversar_mentor2",!1)),w.registerFlag(new s("foi_ao_leito",!1)),w.registerFlag(new s("conversarPaciente",!1)),w.registerFlag(new s("confirmou_pulseira",!1)),w.registerFlag(new s("examinar_paciente",!1)),w.registerFlag(new s("mudar_posicao_paciente",!1)),w.registerFlag(new s("lavarMaos",!1)),w.registerFlag(new s("lavar_maos2",!1)),w.registerFlag(new s("lavar_maos3",!1)),w.registerFlag(new s("coxim",!1)),w.registerFlag(new s("colocou_coxim",!1)),w.registerFlag(new s("pegou_bandeja",!1)),w.registerFlag(new s("score_lavar_maos_antes_exame",!1)),w.registerFlag(new s("score_lavar_maos_depois_exame",!1)),w.registerFlag(new s("score_lavar_maos_prontuario",!1)),w.registerFlag(new s("score_ir_posto_hora_errada",!1)),w.registerFlag(new s("score_falar_paciente",!1)),w.registerFlag(new s("score_verificar_pulseira",!1)),w.registerFlag(new s("score_examinar_paciente",!1)),w.registerFlag(new s("score_pegar_coxim",!1)),w.registerFlag(new s("score_anotar_prontuario",!1)),w.registerFlag(new s("score_ler_prontuario",!1)),w.registerFlag(new s("score_mudar_posicao",!1)),w.registerFlag(new s("lavarMaosAntesInspecao",!1)),w.registerFlag(new s("lavarMaosAntesBandeja",!1)),w.registerFlag(new s("score_lavarMaosAntesBandeja",!1)),w.registerFlag(new s("score_lavarMaosAntesInspecao",!1)),w.registerFlag(new s("score_falar_com_mentor",!1)),w.registerFlag(new s("score_nao_lavar_maos_prontuario",!1)),w.setInitialScene(0),e.registerLevel(w,2)});